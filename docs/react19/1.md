ä¸‹é¢æŠŠ **React 19 çš„ `useFormStatus`** ç»™ä½ **è®²æ¸…æ¥š + ç”¨å¯¹**ï¼Œå¹¶ä¸”**æ˜ç¡®å®ƒå’Œ React Hook Formï¼ˆRHFï¼‰çš„è¾¹ç•Œ**ï¼Œé¿å…æ··ç”¨è¸©å‘ã€‚

---

## ä¸€å¥è¯å…ˆå®šæ€§ï¼ˆå¾ˆé‡è¦ï¼‰

> **`useFormStatus` æ˜¯ React åŸç”Ÿè¡¨å•ï¼ˆForm Actionsï¼‰ä½“ç³»çš„ä¸€éƒ¨åˆ†ï¼Œä¸»è¦ç”¨äº Server Actions / åŸç”Ÿ `<form action={...}>` æäº¤çŠ¶æ€ç®¡ç†**
> â— **å®ƒ â‰  React Hook Form çš„ `formState`**
> â— **ä¸èƒ½ç›´æ¥æ›¿ä»£ RHF çš„ `isSubmitting`**

---

## 1ï¸âƒ£ `useFormStatus` æ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿ

**ä½œç”¨**ï¼š
ğŸ‘‰ è¯»å–**æœ€è¿‘çš„ `<form action={...}>` æäº¤çŠ¶æ€**
ğŸ‘‰ ç”¨æ¥åšï¼š**loadingã€disabledã€pending UI**

```ts
const { pending, data, method, action } = useFormStatus()
```

### è¿”å›å€¼è¯´æ˜

| å­—æ®µ        | å«ä¹‰                 |
| --------- | ------------------ |
| `pending` | è¡¨å•æ˜¯å¦æ­£åœ¨æäº¤ï¼ˆæœ€å¸¸ç”¨ï¼‰      |
| `data`    | æäº¤çš„ FormDataï¼ˆåªè¯»ï¼‰   |
| `method`  | æäº¤æ–¹æ³•ï¼ˆPOST / GETï¼‰   |
| `action`  | å½“å‰ form ç»‘å®šçš„ action |

---

## 2ï¸âƒ£ æœ€åŸºç¡€ç¤ºä¾‹ï¼ˆReact 19 åŸç”Ÿè¡¨å•ï¼‰

```tsx
import { useFormStatus } from "react-dom"

function SubmitButton() {
  const { pending } = useFormStatus()

  return (
    <button type="submit" disabled={pending}>
      {pending ? "æäº¤ä¸­..." : "æäº¤"}
    </button>
  )
}

export default function Page() {
  async function submitAction(formData: FormData) {
    "use server"
    await new Promise((r) => setTimeout(r, 1000))
  }

  return (
    <form action={submitAction}>
      <input name="email" />
      <SubmitButton />
    </form>
  )
}
```

### ğŸ“Œ æ ¸å¿ƒè§„åˆ™ï¼ˆæ–°æ‰‹æœ€å®¹æ˜“é”™ï¼‰

* `useFormStatus()` **å¿…é¡»åœ¨ `<form>` å†…éƒ¨ç»„ä»¶ä½¿ç”¨**
* **ä¸èƒ½åœ¨ form å¤–éƒ¨è°ƒç”¨**
* å®ƒåªæ„ŸçŸ¥ **æœ€è¿‘çš„ form action æäº¤**

---

## 3ï¸âƒ£ `useFormStatus` çš„å…¸å‹ä½¿ç”¨åœºæ™¯ï¼ˆä¼ä¸šçº§ï¼‰

### âœ… åœºæ™¯ 1ï¼šæäº¤æŒ‰é’® Loading / ç¦ç”¨

```tsx
const { pending } = useFormStatus()

<button disabled={pending}>
```

### âœ… åœºæ™¯ 2ï¼šè¡¨å•å…¨å±€é®ç½©

```tsx
function FormMask() {
  const { pending } = useFormStatus()
  if (!pending) return null
  return <div className="mask">å¤„ç†ä¸­...</div>
}
```

---

## 4ï¸âƒ£ â—é‡ç‚¹ï¼š`useFormStatus` â‰  React Hook Form

### å¯¹æ¯”è¡¨ï¼ˆéå¸¸é‡è¦ï¼‰

| èƒ½åŠ›                    | `useFormStatus` | React Hook Form |
| --------------------- | --------------- | --------------- |
| è¡¨å•æ ¡éªŒ                  | âŒ               | âœ…               |
| å­—æ®µé”™è¯¯ç®¡ç†                | âŒ               | âœ…               |
| è¡¨å•çŠ¶æ€ï¼ˆdirty / touchedï¼‰ | âŒ               | âœ…               |
| æäº¤ loading            | âœ…               | âœ…               |
| Server Action åŸç”Ÿæ”¯æŒ    | âœ…               | âŒ               |
| Client-only è¡¨å•        | âŒ               | âœ…               |

ğŸ‘‰ **å®ƒä»¬ä¸æ˜¯ç«äº‰å…³ç³»ï¼Œæ˜¯ä¸¤ä¸ªä½“ç³»**

---

## 5ï¸âƒ£ èƒ½ä¸èƒ½ã€Œä¸€èµ·ç”¨ã€ï¼Ÿâ€”â€”ç»“è®ºï¼šâŒ ä¸æ¨è

### âŒ é”™è¯¯æ··ç”¨ç¤ºä¾‹

```tsx
<form action={submitAction} onSubmit={handleSubmit(onSubmit)}>
```

è¿™æ˜¯ **åæ¨¡å¼**ï¼š

* RHF æƒ³æ¥ç®¡ submit
* React Form Action ä¹Ÿæƒ³æ¥ç®¡ submit
* çŠ¶æ€ä¼šæ··ä¹±

---

## 6ï¸âƒ£ æ­£ç¡®çš„ç»„åˆæ–¹å¼ï¼ˆæ¨èï¼‰

### âœ… æ–¹æ¡ˆ Aï¼š**çº¯ Client è¡¨å•ï¼ˆRHFï¼‰**

ğŸ‘‰ **ä¸ç”¨ `useFormStatus`**

```tsx
const { formState: { isSubmitting } } = useForm()

<button disabled={isSubmitting} />
```

### âœ… æ–¹æ¡ˆ Bï¼š**çº¯ Server Action è¡¨å•**

ğŸ‘‰ **ä¸ç”¨ RHF**

```tsx
<form action={action}>
  <SubmitButton />
</form>
```

### âœ… æ–¹æ¡ˆ Cï¼š**RHF + æ‰‹åŠ¨ Server è°ƒç”¨ï¼ˆæ¨èä¼ä¸šçº§ï¼‰**

```tsx
const onSubmit = async (values) => {
  setLoading(true)
  await fetch("/api/submit", { method: "POST", body: JSON.stringify(values) })
  setLoading(false)
}
```

> âœ” çŠ¶æ€ç»Ÿä¸€
> âœ” é”™è¯¯å¯æ§
> âœ” æ ¡éªŒå®Œæ•´

---

## 7ï¸âƒ£ å¦‚æœä½ â€œç¡¬è¦ç»“åˆâ€RHF + Server Actionï¼ˆè¿›é˜¶ï¼‰

> âš ï¸ åªé€‚åˆé«˜çº§ç”¨æˆ·

```tsx
<form
  action={async (formData) => {
    "use server"
    // æœåŠ¡ç«¯å¤„ç†
  }}
  onSubmit={(e) => {
    e.preventDefault()
    handleSubmit(onSubmit)()
  }}
>
```

ğŸ“Œ **æ³¨æ„**

* `useFormStatus` åªåæ˜  `action` çŠ¶æ€
* RHF çš„ `isSubmitting` æ˜¯å¦ä¸€å¥—çŠ¶æ€
* **ä¸¤ä¸ª loading ä¸ä¸€å®šåŒæ­¥**

ğŸ‘‰ å®æˆ˜ä¸­ **90% ä¸æ¨è**

---

## 8ï¸âƒ£ ä»€ä¹ˆæ—¶å€™ä½ ã€Œåº”è¯¥ç”¨ã€`useFormStatus`ï¼Ÿ

âœ” ä½ åœ¨ç”¨ **React 19 / Next.js App Router**
âœ” è¡¨å• **ç›´æ¥æäº¤ç»™ Server Action**
âœ” ä¸éœ€è¦å¤æ‚å‰ç«¯æ ¡éªŒ
âœ” å CRUD / å†…éƒ¨å·¥å…·

âŒ ä»¥ä¸‹æƒ…å†µåˆ«ç”¨ï¼š

* è¡¨å•å¤æ‚æ ¡éªŒ
* å¤šå­—æ®µè”åŠ¨
* åŠ¨æ€æ•°ç»„
* å¼º UI åé¦ˆ

---

## æ€»ç»“ï¼ˆè®°ä½è¿™ 3 å¥è¯ï¼‰

1ï¸âƒ£ **`useFormStatus` æ˜¯â€œåŸç”Ÿè¡¨å•æäº¤çŠ¶æ€ Hookâ€**
2ï¸âƒ£ **å®ƒä¸æ˜¯ RHF çš„æ›¿ä»£å“**
3ï¸âƒ£ **å¤æ‚è¡¨å• = RHFï¼Œç®€å• Server è¡¨å• = useFormStatus**

---

å¦‚æœä½ æ„¿æ„ï¼Œä¸‹ä¸€æ­¥æˆ‘å¯ä»¥å¸®ä½ åšï¼š

* âœ… **RHF + Server Action çš„æœ€ä½³å®è·µæ¨¡æ¿**
* âœ… **ä»€ä¹ˆæ—¶å€™è¯¥â€œæŠ›å¼ƒ RHFâ€ç›´æ¥ç”¨ React 19 è¡¨å•**
* âœ… **App Router ä¸­è¡¨å•æ¶æ„è®¾è®¡ï¼ˆå‰åç«¯ä¸€ä½“ï¼‰**

ä½ ç°åœ¨æ˜¯åœ¨ **Next.js App Router + React 19** åœºæ™¯å—ï¼Ÿ
